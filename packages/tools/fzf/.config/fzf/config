#!/usr/bin/env bash
# FZF minimal configuration

# Gruvbox color scheme
export FZF_DEFAULT_OPTS="
--color=bg+:#3c3836,bg:#1d2021,spinner:#fb4934,hl:#928374
--color=fg:#ebdbb2,header:#928374,info:#8ec07c,pointer:#fb4934
--color=marker:#fb4934,fg+:#ebdbb2,prompt:#fb4934,hl+:#fb4934
--height=40%
--layout=reverse
--border"

# Use fd if available, otherwise find
if command -v fd >/dev/null 2>&1; then
    export FZF_DEFAULT_COMMAND='fd --type f --hidden --follow --exclude .git'
    export FZF_ALT_C_COMMAND='fd --type d --hidden --follow --exclude .git'
fi

# Enhanced file preview with bat if available
if command -v bat >/dev/null 2>&1; then
    export FZF_CTRL_T_OPTS="--preview 'bat --color=always --style=numbers --line-range=:100 {}'"
elif command -v cat >/dev/null 2>&1; then
    export FZF_CTRL_T_OPTS="--preview 'head -100 {}'"
fi

# Directory preview with tree or ls
if command -v tree >/dev/null 2>&1; then
    export FZF_ALT_C_OPTS="--preview 'tree -C {} | head -100'"
elif command -v ls >/dev/null 2>&1; then
    export FZF_ALT_C_OPTS="--preview 'ls -la {} | head -100'"
fi

# History search with preview
export FZF_CTRL_R_OPTS="--preview 'echo {}' --preview-window down:3:hidden:wrap --bind '?:toggle-preview'"
